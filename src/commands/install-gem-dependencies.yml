description: >
  Restores, installs and caches Gems
parameters:
  cache-prefix:
    type: string
    default: ""
  cache-version:
    type: string
  directory:
    type: string
    default: .
steps:
  - restore_cache:
      keys:
        - <<parameters.cache-version>>-<<parameters.cache-prefix>>-gem-cache-{{ checksum "<< parameters.directory >>/Gemfile.lock" }}
  - run:
      name: Bundle install
      working_directory: << parameters.directory >>
      command: <<include(scripts/bundle-install.sh)>>
  - save_cache:
      key: <<parameters.cache-version>>-<<parameters.cache-prefix>>-gem-cache-{{ checksum "<< parameters.directory >>/Gemfile.lock" }}
      paths:
        - vendor/bundle
