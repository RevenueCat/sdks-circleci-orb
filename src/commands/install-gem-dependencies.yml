description: >
  Restores, installs and caches Gems
parameters:
  parameters:
  cache-prefix:
    type: string
    default: ""
  cache-version:
    type: string
    default: v1
steps:
  - restore_cache:
      keys:
        - <<parameters.cache-version>>-<<parameters.cache-prefix>>-gem-cache-{{ checksum "Gemfile.lock" }}
  - run:
      name: Bundle install
      command: |
        bundle config set --local clean 'true'
        bundle config set --local path 'vendor/bundle'
        bundle install
  - save_cache:
      key: <<parameters.cache-version>>-<<parameters.cache-prefix>>-gem-cache-{{ checksum "Gemfile.lock" }}
      paths:
        - vendor/bundle
